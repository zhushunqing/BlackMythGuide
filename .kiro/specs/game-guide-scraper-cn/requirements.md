# 需求文档

## 简介

本项目旨在开发一个网页爬虫，专门用于抓取游戏"黑神话悟空"的攻略内容。爬虫将从指定的起始URL（https://www.gamersky.com/handbook/202408/1803231.shtml）开始，抓取所有相关页面内容，包括"下一页"链接指向的所有页面。最终，爬虫将把所有抓取的内容整理成一本结构化的攻略书，方便用户阅读和查询。

## 需求

### 需求1：网页内容抓取

**用户故事：** 作为一名"黑神话悟空"的玩家，我希望能够抓取完整的游戏攻略内容，以便我可以离线阅读和参考。

#### 验收标准

1. 当提供起始URL（https://www.gamersky.com/handbook/202408/1803231.shtml）时，系统应当能够访问并抓取该页面的内容。
2. 当页面包含"下一页"链接时，系统应当能够识别并跟随这些链接，抓取所有相关页面。
3. 当抓取页面时，系统应当能够正确处理网页编码，确保中文内容正确显示。
4. 当网络连接不稳定时，系统应当能够实现重试机制，确保内容完整抓取。
5. 当抓取过程中遇到错误时，系统应当记录错误信息并继续尝试抓取其他页面。

### 需求2：内容解析与提取

**用户故事：** 作为一名游戏攻略的读者，我希望爬虫能够准确提取攻略的文本、图片和结构，以便我能够获得完整且格式良好的攻略内容。

#### 验收标准

1. 当解析网页时，系统应当能够提取标题、正文、图片和其他相关内容元素。
2. 当遇到图片时，系统应当能够下载并保存图片，同时维护图片与文本的关联关系。
3. 当页面包含特殊格式（如表格、列表等）时，系统应当能够保留这些格式信息。
4. 当解析内容时，系统应当能够过滤掉广告、导航栏等无关内容。
5. 当提取内容时，系统应当能够保留原始内容的层次结构（如章节、小节等）。

### 需求3：攻略书生成

**用户故事：** 作为一名游戏玩家，我希望将抓取的攻略内容整理成一本结构化的电子书，以便我能够方便地阅读和查询特定信息。

#### 验收标准

1. 当所有内容抓取完成后，系统应当能够将内容整合成一个结构化的文档。
2. 当生成攻略书时，系统应当能够创建目录，方便导航到不同章节。
3. 当生成攻略书时，系统应当能够以Markdown格式输出内容。
4. 当生成攻略书时，系统应当能够正确嵌入和显示所有图片。
5. 当生成攻略书时，系统应当能够保持原始内容的格式和结构。

### 需求4：用户配置与控制

**用户故事：** 作为应用的使用者，我希望能够控制爬虫的行为和输出格式，以便我能够根据自己的需求定制攻略书。

#### 验收标准

1. 当启动爬虫时，系统应当允许用户指定起始URL。
2. 当配置爬虫时，系统应当确保输出格式为Markdown。
3. 当配置爬虫时，系统应当允许用户设置爬取速度，以避免对目标网站造成过大负载。
4. 当配置爬虫时，系统应当允许用户指定是否下载图片。
5. 当爬虫运行时，系统应当提供进度信息，让用户了解当前抓取状态。

### 需求5：爬虫性能与礼貌性

**用户故事：** 作为一个开发者，我希望爬虫能够采取措施减轻对目标网站的负担，以礼貌地获取内容。

#### 验收标准

1. 当发送请求时，系统应当使用合理的请求头，包括User-Agent信息。
2. 当抓取内容时，系统应当实现请求延迟，避免短时间内发送过多请求。
3. 当抓取内容时，系统应当避免并行发送大量请求，以减轻目标服务器负担。
4. 当使用抓取的内容时，系统应当保留并显示原始内容的来源信息。